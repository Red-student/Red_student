<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Secret Page</title>
</head>
<body>
<h1>Welcome to the Secret Page</h1>
<form id="loginForm">
  <label for="username">Username:</label><br>
  <input type="text" id="username" name="username"><br>
  <label for="password">Password:</label><br>
  <input type="password" id="password" name="password"><br>
  <label for="secretWord">Secret Word:</label><br>
  <input type="text" id="secretWord" name="secretWord"><br><br>
  <button type="submit">Submit</button>
</form>
<div id="secretData" style="display: none;">
  <h2>Secret Data</h2>
  <p id="dataFromCookie"></p>
</div>

<button id="showDataButton" type="button" style="display: none;">Show Secret Data</button>

<script>
  document.getElementById("loginForm").addEventListener("submit", function(event) {
    event.preventDefault(); // Предотвращаем стандартное действие формы
    var username = document.getElementById("username").value;
    var password = document.getElementById("password").value;
    var secretWord = document.getElementById("secretWord").value;

    // Проверка логина, пароля и секретного слова (можешь здесь добавить свою логику проверки)

    if (secretWord === "твоё_секретное_слово") {
      document.getElementById("secretData").style.display = "block";
      var userData = "Username: " + username + "<br>Password: " + password;
      document.getElementById("dataFromCookie").innerHTML = userData;

      // Сохранение данных в cookie с указанием пути '/'
      var expiryDate = new Date();
      expiryDate.setDate(expiryDate.getDate() + 2); // Сегодня + 2 дня
      var cookieValue = "userData=" + userData + ";expires=" + expiryDate.toUTCString() + ";path=/";
      document.cookie = cookieValue;

      // Показать кнопку после успешного входа
      document.getElementById("showDataButton").style.display = "block";
    } else {
      alert("Incorrect secret word!");
    }
  });

  // Получение текущей даты и установка срока хранения cookie
  var expiryDate = new Date();
  expiryDate.setDate(expiryDate.getDate() + 2); // Сегодня + 2 дня
  document.cookie = "expiryDate=" + expiryDate.toUTCString() + ";path=/";

  // Проверка срока годности cookie
  function checkCookieExpiry() {
    var cookies = document.cookie.split("; ");
    cookies.forEach(function(cookie) {
      var cookiePair = cookie.split("=");
      var cookieName = cookiePair[0];
      var cookieValue = cookiePair[1];
      if (cookieName === "expiryDate") {
        var expiryDate = new Date(cookieValue);
        if (expiryDate < new Date()) {
          alert("Cookie has expired!");
        }
      }
    });
  }

  // Функция для отображения секретных данных при запросе
  function showSecretData() {
    var cookies = document.cookie.split("; ");
    var correctSecretWord = false;
    var buttonClicked = false;

    // Проверяем наличие правильного секретного слова в cookie
    cookies.forEach(function(cookie) {
      var cookiePair = cookie.split("=");
      var cookieName = cookiePair[0];
      var cookieValue = cookiePair[1];
      if (cookieName === "userData") {
        var userData = decodeURIComponent(cookieValue);
        var userDataArray = userData.split("&");
        userDataArray.forEach(function(item) {
          if (item.split("=")[0] === "secretWord" && item.split("=")[1] === "твоё_секретное_слово") {
            correctSecretWord = true;
          }
        });
      }
    });

    // Проверяем, нажата ли кнопка "Показать секретные данные"
    buttonClicked = true;

    // Если оба условия выполнены, показываем секретные данные
    if (correctSecretWord && buttonClicked) {
      document.getElementById("secretData").style.display = "block";
      document.getElementById("dataFromCookie").innerHTML = "Secret Data: твои_секретные_данные";
    } else {
      alert("To show secret data, enter the correct secret word and click the button.");
    }
  }

  // Вызов функции проверки при загрузке страницы
  checkCookieExpiry();

  // Вызов функции при клике на кнопку запроса
  document.getElementById("showDataButton").addEventListener("click", showSecretData);
</script>
</body>
</html>